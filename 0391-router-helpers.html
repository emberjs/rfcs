<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>0391-router-helpers - </title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="affix"><a href="introduction.html">Introduction</a></li><li><a href="0001-transform-attribute-meta-parameter.html">0001-transform-attribute-meta-parameter</a></li><li><a href="0003-block-params.html">0003-block-params</a></li><li><a href="0003-cli-ember-doctor.html">0003-cli-ember-doctor</a></li><li><a href="0010-engines.html">0010-engines</a></li><li><a href="0011-improved-cp-syntax.html">0011-improved-cp-syntax</a></li><li><a href="0012-help-json-output.html">0012-help-json-output</a></li><li><a href="0015-the-road-to-ember-2-0.html">0015-the-road-to-ember-2-0</a></li><li><a href="0020-sri-default.html">0020-sri-default</a></li><li><a href="0023-command-line-completion.html">0023-command-line-completion</a></li><li><a href="0024-bound-attributes.html">0024-bound-attributes</a></li><li><a href="0028-app-import-output-file.html">0028-app-import-output-file</a></li><li><a href="0029-addon-black-and-whitelist-for-apps.html">0029-addon-black-and-whitelist-for-apps</a></li><li><a href="0045-internet-explorer.html">0045-internet-explorer</a></li><li><a href="0046-cli-improved-release-process.html">0046-cli-improved-release-process</a></li><li><a href="0046-registry-reform.html">0046-registry-reform</a></li><li><a href="0050-cli-production-code-stripping.html">0050-cli-production-code-stripping</a></li><li><a href="0050-improved-actions.html">0050-improved-actions</a></li><li><a href="0053-helpers.html">0053-helpers</a></li><li><a href="0055-anonymous-amd.html">0055-anonymous-amd</a></li><li><a href="0056-improved-release-cycle.html">0056-improved-release-cycle</a></li><li><a href="0057-ember-data-reference-unification.html">0057-ember-data-reference-unification</a></li><li><a href="0058-helper-listing.html">0058-helper-listing</a></li><li><a href="0061-ember-data-background-fetch.html">0061-ember-data-background-fetch</a></li><li><a href="0064-contextual-component-lookup.html">0064-contextual-component-lookup</a></li><li><a href="0065-deprecation-warning-handlers.html">0065-deprecation-warning-handlers</a></li><li><a href="0080-serve-file-api.html">0080-serve-file-api</a></li><li><a href="0086-firefox-in-ci.html">0086-firefox-in-ci</a></li><li><a href="0090-addon-tree-caching.html">0090-addon-tree-caching</a></li><li><a href="0091-cli-addon-instrumentation-experimental-hooks.html">0091-cli-addon-instrumentation-experimental-hooks</a></li><li><a href="0091-weakmap.html">0091-weakmap</a></li><li><a href="0092-blueprint-remove-old-files.html">0092-blueprint-remove-old-files</a></li><li><a href="0095-cli-standardise-targets.html">0095-cli-standardise-targets</a></li><li><a href="0095-router-service.html">0095-router-service</a></li><li><a href="0096-enable-yarn-usage.html">0096-enable-yarn-usage</a></li><li><a href="0101-ember-data-friendly-errors.html">0101-ember-data-friendly-errors</a></li><li><a href="0105-addons-optionalDependencies.html">0105-addons-optionalDependencies</a></li><li><a href="0108-add-custom-transform.html">0108-add-custom-transform</a></li><li><a href="0110-packaging.html">0110-packaging</a></li><li><a href="0114-add-template-lint-addon.html">0114-add-template-lint-addon</a></li><li><a href="0116-qunit-dom.html">0116-qunit-dom</a></li><li><a href="0120-cli-guides.html">0120-cli-guides</a></li><li><a href="0120-route-serializers.html">0120-route-serializers</a></li><li><a href="0121-remove-ember-cli-eslint.html">0121-remove-ember-cli-eslint</a></li><li><a href="0136-contains-to-includes.html">0136-contains-to-includes</a></li><li><a href="0139-isHtmlSafe.html">0139-isHtmlSafe</a></li><li><a href="0143-module-unification.html">0143-module-unification</a></li><li><a href="0150-factory-for.html">0150-factory-for</a></li><li><a href="0176-javascript-module-api.html">0176-javascript-module-api</a></li><li><a href="0178-deprecate-ember-k.html">0178-deprecate-ember-k</a></li><li><a href="0181-deprecate-ember-data-initializers.html">0181-deprecate-ember-data-initializers</a></li><li><a href="0186-track-unique-history-location-state.html">0186-track-unique-history-location-state</a></li><li><a href="0191-deprecate-component-lifecycle-hook-args.html">0191-deprecate-component-lifecycle-hook-args</a></li><li><a href="0194-deprecate-custom-event-manager.html">0194-deprecate-custom-event-manager</a></li><li><a href="0213-custom-components.html">0213-custom-components</a></li><li><a href="0225-ember-engines-mount-params.html">0225-ember-engines-mount-params</a></li><li><a href="0226-named-blocks.html">0226-named-blocks</a></li><li><a href="0229-deprecate-testing-restricted-resolver.html">0229-deprecate-testing-restricted-resolver</a></li><li><a href="0232-simplify-qunit-testing-api.html">0232-simplify-qunit-testing-api</a></li><li><a href="0236-deprecation-ember-string.html">0236-deprecation-ember-string</a></li><li><a href="0237-deprecation-ember-map.html">0237-deprecation-ember-map</a></li><li><a href="0240-es-classes.html">0240-es-classes</a></li><li><a href="0252-browser-support-changes.html">0252-browser-support-changes</a></li><li><a href="0268-acceptance-testing-refactor.html">0268-acceptance-testing-refactor</a></li><li><a href="0272-deprecation-native-function-prototype-extensions.html">0272-deprecation-native-function-prototype-extensions</a></li><li><a href="0276-named-args.html">0276-named-args</a></li><li><a href="0278-template-only-components.html">0278-template-only-components</a></li><li><a href="0280-remove-application-wrapper.html">0280-remove-application-wrapper</a></li><li><a href="0281-es5-getters.html">0281-es5-getters</a></li><li><a href="0286-block-let-template-helper.html">0286-block-let-template-helper</a></li><li><a href="0287-promote-in-element-to-public-api.html">0287-promote-in-element-to-public-api</a></li><li><a href="0293-record-data.html">0293-record-data</a></li><li><a href="0294-optional-jquery.html">0294-optional-jquery</a></li><li><a href="0297-deprecate-ember-logger.html">0297-deprecate-ember-logger</a></li><li><a href="0300-rfc-process-update.html">0300-rfc-process-update</a></li><li><a href="0308-deprecate-property-lookup-fallback.html">0308-deprecate-property-lookup-fallback</a></li><li><a href="0311-angle-bracket-invocation.html">0311-angle-bracket-invocation</a></li><li><a href="0318-array-helper.html">0318-array-helper</a></li><li><a href="0322-deprecate-copy-copyable.html">0322-deprecate-copy-copyable</a></li><li><a href="0324-deprecate-component-isvisible.html">0324-deprecate-component-isvisible</a></li><li><a href="0326-ember-data-filter-deprecation.html">0326-ember-data-filter-deprecation</a></li><li><a href="0329-deprecated-ember-evented-in-ember-data.html">0329-deprecated-ember-evented-in-ember-data</a></li><li><a href="0331-deprecate-globals-resolver.html">0331-deprecate-globals-resolver</a></li><li><a href="0332-ember-data-record-links-and-meta.html">0332-ember-data-record-links-and-meta</a></li><li><a href="0335-deprecate-send-action.html">0335-deprecate-send-action</a></li><li><a href="0337-native-class-constructor-update.html">0337-native-class-constructor-update</a></li><li><a href="0340-deprecate-ember-merge.html">0340-deprecate-ember-merge</a></li><li><a href="0345-discord.html">0345-discord</a></li><li><a href="0364-roadmap-2018.html">0364-roadmap-2018</a></li><li><a href="0369-deprecate-computed-clobberability.html">0369-deprecate-computed-clobberability</a></li><li><a href="0370-deprecate-computed-volatile.html">0370-deprecate-computed-volatile</a></li><li><a href="0372-ember-data-model-factory-for.html">0372-ember-data-model-factory-for</a></li><li><a href="0373-Element-Modifier-Managers.html">0373-Element-Modifier-Managers</a></li><li><a href="0375-deprecate-computed-property-modifier.html">0375-deprecate-computed-property-modifier</a></li><li><a href="0386-remove-jquery.html">0386-remove-jquery</a></li><li><a href="0389-dynamic-tag-names.html">0389-dynamic-tag-names</a></li><li><a href="0391-router-helpers.html" class="active">0391-router-helpers</a></li><li><a href="0392-deprecate-component-manager-string-lookup.html">0392-deprecate-component-manager-string-lookup</a></li><li><a href="0395-ember-data-packages.html">0395-ember-data-packages</a></li><li><a href="0398-RouteInfo-Metadata.html">0398-RouteInfo-Metadata</a></li><li><a href="0403-ember-data-identifiers.html">0403-ember-data-identifiers</a></li><li><a href="0408-decorators.html">0408-decorators</a></li><li><a href="0410-tracked-properties.html">0410-tracked-properties</a></li><li><a href="0415-render-element-modifiers.html">0415-render-element-modifiers</a></li><li><a href="0416-glimmer-components.html">0416-glimmer-components</a></li><li><a href="0418-deprecate-route-render-methods.html">0418-deprecate-route-render-methods</a></li><li><a href="0421-deprecate-application-controller-props.html">0421-deprecate-application-controller-props</a></li><li><a href="0425-website-redesign.html">0425-website-redesign</a></li><li><a href="0431-guides-restructure.html">0431-guides-restructure</a></li><li><a href="0432-contextual-helpers.html">0432-contextual-helpers</a></li><li><a href="0435-modifier-splattributes.html">0435-modifier-splattributes</a></li><li><a href="0440-decorator-support.html">0440-decorator-support</a></li><li><a href="0445-deprecate-with.html">0445-deprecate-with</a></li><li><a href="0446-contribution-guides.html">0446-contribution-guides</a></li><li><a href="0449-deprecate-partials.html">0449-deprecate-partials</a></li><li><a href="0451-injection-parameter-normalization.html">0451-injection-parameter-normalization</a></li><li><a href="0452-ember-data-medium-term-plan.html">0452-ember-data-medium-term-plan</a></li><li><a href="0457-nested-lookups.html">0457-nested-lookups</a></li><li><a href="0459-angle-bracket-built-in-components.html">0459-angle-bracket-built-in-components</a></li><li><a href="0460-yieldable-named-blocks.html">0460-yieldable-named-blocks</a></li><li><a href="0461-ember-data-singleton-record-data.html">0461-ember-data-singleton-record-data</a></li><li><a href="0463-record-data-state.html">0463-record-data-state</a></li><li><a href="0465-record-data-errors.html">0465-record-data-errors</a></li><li><a href="0466-request-state-service.html">0466-request-state-service</a></li><li><a href="0468-classic-decorator.html">0468-classic-decorator</a></li><li><a href="0470-fn-helper.html">0470-fn-helper</a></li><li><a href="0471-on-modifier.html">0471-on-modifier</a></li><li><a href="0477-blueprints-update.html">0477-blueprints-update</a></li><li><a href="0478-tracked-properties-updates.html">0478-tracked-properties-updates</a></li><li><a href="0481-component-templates-co-location.html">0481-component-templates-co-location</a></li><li><a href="0486-deprecate-mouseenter.html">0486-deprecate-mouseenter</a></li><li><a href="0487-custom-model-classes.html">0487-custom-model-classes</a></li><li><a href="0491-deprecate-disconnect-outlet.html">0491-deprecate-disconnect-outlet</a></li><li><a href="0494-async-observers.html">0494-async-observers</a></li><li><a href="0496-handlebars-strict-mode.html">0496-handlebars-strict-mode</a></li><li><a href="0507-embroider-v2-package-format.html">0507-embroider-v2-package-format</a></li><li><a href="0519-2019-2020-roadmap.html">0519-2019-2020-roadmap</a></li><li><a href="0521-find-by-identifier.html">0521-find-by-identifier</a></li><li><a href="0522-default-serializers-and-adapters.html">0522-default-serializers-and-adapters</a></li><li><a href="0523-model-argument-for-route-templates.html">0523-model-argument-for-route-templates</a></li><li><a href="0554-deprecate-getwithdefault.html">0554-deprecate-getwithdefault</a></li><li><a href="0558-edition-detection.html">0558-edition-detection</a></li><li><a href="0560-add-equality-operators.html">0560-add-equality-operators</a></li><li><a href="0561-add-numeric-comparison-operators.html">0561-add-numeric-comparison-operators</a></li><li><a href="0562-add-logical-operators.html">0562-add-logical-operators</a></li><li><a href="0566-memo-decorator.html">0566-memo-decorator</a></li><li><a href="0580-destroyables.html">0580-destroyables</a></li><li><a href="0581-new-test-waiters.html">0581-new-test-waiters</a></li><li><a href="0585-improved-ember-registry-apis.html">0585-improved-ember-registry-apis</a></li><li><a href="0615-autotracking-memoization.html">0615-autotracking-memoization</a></li><li><a href="0617-rfc-stages.html">0617-rfc-stages</a></li><li><a href="0625-helper-managers.html">0625-helper-managers</a></li><li><a href="0626-invoke-helper.html">0626-invoke-helper</a></li><li><a href="0628-prettier.html">0628-prettier</a></li><li><a href="0631-refresh-method-for-router-service.html">0631-refresh-method-for-router-service</a></li><li><a href="0635-ember-new-lang.html">0635-ember-new-lang</a></li><li><a href="0637-customizable-test-setups.html">0637-customizable-test-setups</a></li><li><a href="0638-interactive-app-creation.html">0638-interactive-app-creation</a></li><li><a href="0639-replace-blacklist-whitelist.html">0639-replace-blacklist-whitelist</a></li><li><a href="0645-add-ember-page-title-addon.html">0645-add-ember-page-title-addon</a></li><li><a href="0649-deprecation-staging.html">0649-deprecation-staging</a></li><li><a href="0659-unique-id-helper.html">0659-unique-id-helper</a></li><li><a href="0669-tracked-storage-primitive.html">0669-tracked-storage-primitive</a></li><li><a href="0671-modernize-built-in-components-1.html">0671-modernize-built-in-components-1</a></li><li><a href="0673-deprecate-tryinvoke.html">0673-deprecate-tryinvoke</a></li><li><a href="0674-deprecate-transition-methods-of-controller-and-route.html">0674-deprecate-transition-methods-of-controller-and-route</a></li><li><a href="0680-implicit-injection-deprecation.html">0680-implicit-injection-deprecation</a></li><li><a href="0685-new-browser-support-policy.html">0685-new-browser-support-policy</a></li><li><a href="0686-deprecate-old-manager-capabilities-versions.html">0686-deprecate-old-manager-capabilities-versions</a></li><li><a href="0689-deprecate-has-block.html">0689-deprecate-has-block</a></li><li><a href="0690-deprecate-attrs-in-templates.html">0690-deprecate-attrs-in-templates</a></li><li><a href="0691-deprecate-class-binding-and-class-name-bindings.html">0691-deprecate-class-binding-and-class-name-bindings</a></li><li><a href="0692-deprecate-array-observers.html">0692-deprecate-array-observers</a></li><li><a href="0698-deprecate-link-to-positional-arguments.html">0698-deprecate-link-to-positional-arguments</a></li><li><a href="0702-eslint-plugin-qunit.html">0702-eslint-plugin-qunit</a></li><li><a href="0704-deprecate-octane-optional-features.html">0704-deprecate-octane-optional-features</a></li><li><a href="0705-deprecate-jquery-optional-feature.html">0705-deprecate-jquery-optional-feature</a></li><li><a href="0706-deprecate-ember-global.html">0706-deprecate-ember-global</a></li><li><a href="0707-modernize-built-in-components-2.html">0707-modernize-built-in-components-2</a></li><li><a href="0711-deprecate-auto-location.html">0711-deprecate-auto-location</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"></h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>Start Date: 2018-10-22
Relevant Team(s): Ember.js
RFC PR: https://github.com/emberjs/rfcs/pull/391
Tracking: https://github.com/emberjs/rfc-tracking/issues/14</p>
<hr />
<h1><a class="header" href="#router-helpers" id="router-helpers">Router Helpers</a></h1>
<h2><a class="header" href="#summary" id="summary">Summary</a></h2>
<p>This RFC introduces new router helpers that represent a decomposition of functionality of what we commonly use <code>{{link-to}}</code> for. Below is a list of the new helpers:</p>
<pre><code class="language-hbs">{{url-for}}
{{root-url}}
{{is-active}}
{{is-loading}}
{{is-transitioning-in}}
{{is-transitioning-out}}
</code></pre>
<p>This represents a super set of the functionality provided by <a href="https://github.com/rwjblue/ember-router-helpers/">Ember Router Helpers</a> which has provided this RFC that confidence that a decomposition is possible.</p>
<p>This RFC does <strong>not</strong> deprecate <code>{{link-to}}</code> or <code>{{query-params}}</code>. These deprecations will come in the form of a deprecation RFC.</p>
<h2><a class="header" href="#motivation" id="motivation">Motivation</a></h2>
<p><code>{{link-to}}</code> is the primary way for Ember applications to transition from route to route in your application. While this works for a lot of cases there are some use cases that are not well supported or supported at all by the framework. Below is an enumeration of cases that <code>{{link-to}}</code> does not address.</p>
<h3><a class="header" href="#anchor-tags" id="anchor-tags">Anchor Tags</a></h3>
<p>We currently do not have a good solution for transitioning solely based on HTML anchors defined in the templating layer. For instance let say you are using <a href="https://github.com/ember-intl/ember-intl">Ember Intl</a> to do internationalization for your application. Ember Intl uses the <a href="http://userguide.icu-project.org/formatparse/messages">ICU message format</a> for the actual translation strings and supports having HTML within the string. Now lets say you want to put a link in a translation string and have it work like <code>{{link-to}}</code> works. In that case you either have to roll your own solution or use something like <a href="https://github.com/intercom/ember-href-to">Ember-href-to</a>. Another example where this would be useful is that links within markdown produced by addons like <a href="https://github.com/gcollazo/ember-cli-showdown">Ember-CLI-Showdown</a> would just work. API's like <code>RouterService#transitionTo</code> can transition an application using relative URLs and we have an opportunity to leverage this functionality to support this use case.</p>
<h3><a class="header" href="#extensibility-of-link-to" id="extensibility-of-link-to">Extensibility Of <code>{{link-to}}</code></a></h3>
<p>In 2.11 we moved <code>LinkComponent</code> from <code>private</code> to <code>public</code> largely because there was no other way to modify the behavior of <code>{{link-to}}</code> and it had effectively become de-facto public API. That being said, it is less than desirable to <code>reopen</code> or <code>extend</code> framework objects to gain access to the functionality to create some application specific primitive. For example <a href="https://github.com/kaliber5/ember-bootstrap/">Ember Bootsrap</a> extends the <a href="https://github.com/kaliber5/ember-bootstrap/blob/master/addon/components/base/bs-dropdown/menu/link-to.js"><code>LinkComponent</code></a> and then layers more functionality on top of it. Addons would be better served if they had access to more primitive functionality.</p>
<h3><a class="header" href="#css-class-magic" id="css-class-magic">CSS Class Magic</a></h3>
<p><code>{{link-to}}</code> adds some convienent, yet not obvious, classes to the element. These classes are:</p>
<ul>
<li><code>active</code>: applied to any <code>{{link-to}}</code> that is on the &quot;active&quot; path</li>
<li><code>disabled</code>: applied depending on the evaluation of <code>disabled=someBool</code></li>
<li><code>loading</code>: applied if one or more of the models passed are <code>undefined</code></li>
<li><code>ember-transitioning-in</code>: applied to links that are about to be <code>active</code></li>
<li><code>ember-transitioning-out</code>: applied to links that are about to be deactivated</li>
</ul>
<p>The issue with these class names is that they are not declared anywhere in your templated and are provided by the <code>LinkComponent</code> as <code>classNameBindings</code>. This effectively creates a set of reserved class names that are highly prone to colissions in your typical application.</p>
<p>Furthermore, addons like <a href="https://github.com/alexspeller/ember-cli-active-link-wrapper">ember-cli-active-link-wrapper</a> and <a href="https://github.com/zoltan-nz/ember-bootstrap-nav-link">ember-bootstarp-nav-link</a> do a ton of work arounds to get things like the <code>.active</code> class to show up on wrapping elements instead of the element directly. This is a great example that shows we are missing some primitives.</p>
<h3><a class="header" href="#default-query-param-serialization" id="default-query-param-serialization">Default Query Param Serialization</a></h3>
<p>Lastly, <code>{{link-to}}</code> has very strange behavior when it comes to serializing query params. On a controller you declare the query params for a specific route. These query params can have defaults for them. For example if you have a controller that looks like:</p>
<pre><code class="language-js">// app/controllers/profile.js
import Controller from '@ember/controller';

export default Controller.extend({
  queryParams: ['someBool'],
  someBool: true,
})
</code></pre>
<p>and you to link to it like this:</p>
<pre><code class="language-hbs">{{#link-to 'profile'}}Profile{{/link-to}}
</code></pre>
<p>In the DOM you will have an <code>href</code> on the anchor that gets serializes as:</p>
<pre><code class="language-html">&lt;a href=&quot;/profile?someBool=true&quot; class=&quot;active ember-view&quot;&gt;Profile&lt;/a&gt;
</code></pre>
<p>Looking at a template you would have no idea that rendering the <code>{{link-to}}</code> would result in the query params being serialized. From an implementation point of view, this is problematic as we are forced to <code>lookup</code> the <code>Route</code> and the associated <code>Controller</code> to grab the query params. This can add a non-trivial amount of overhead during rendering, especially if you have many <code>{{link-to}}</code>s on a route that link many different parts of your application. As a side-note, this is one of the things  that needs to be dealt with if we are ever to kill controllers.</p>
<h3><a class="header" href="#does-not-work-with-angle-bracket-invocation" id="does-not-work-with-angle-bracket-invocation">Does Not Work With Angle Bracket Invocation</a></h3>
<p>Since angle bracket invocation does not support positional params, <code>{{link-to}}</code> has to adapt its public API.</p>
<h3><a class="header" href="#costly-api" id="costly-api">Costly API</a></h3>
<p><code>{{link-to}}</code> has <a href="#kitchen-sink">a lot of functionality</a>, however this functionality does come at a cost for every instance of <code>{{link-to}}</code>. This is not ideal especially if you're just using <code>{{link-to}}</code> to generate a url that can be transitioned to. By providing fine grain control of the functionality, applications should see a performance boost.</p>
<h2><a class="header" href="#detailed-design" id="detailed-design">Detailed design</a></h2>
<p>Below is a detailed design of all of the template helpers.</p>
<h3><a class="header" href="#url-generation-helpers" id="url-generation-helpers">URL Generation Helpers</a></h3>
<p>The following helpers are to be used to construct a valid root-relative URL that will be used by the event dispatcher to perform a transition. These helpers <strong>do not</strong> pass the in memory model, meaning the model hook will always run for the route you are transitioning to.</p>
<h3><a class="header" href="#url-for-helper" id="url-for-helper"><code>{{url-for}}</code> Helper</a></h3>
<pre><code class="language-hbs">{{url-for routeName model queryParams=(hash a=a)}}
</code></pre>
<p>Or</p>
<pre><code class="language-hbs">{{url-for routeName models=model queryParams=(hash a=a)}}
</code></pre>
<p><code>{{url-for}}</code> generates a root-relative URL as a string (which will include the application's rootUrl). When the link is clicked it will cause a transition to occur. See the <a href="#event-dispatcher-changes">Event Dispatcher Changes</a>. It will not serialize the default query params on the controller.</p>
<h4><a class="header" href="#signature-explainer" id="signature-explainer">Signature Explainer</a></h4>
<p>Using the example above:</p>
<p><em>Positional Params</em></p>
<ul>
<li><strong><code>routeName</code></strong> <em>String</em>: A fully-qualified name of this route, like <code>&quot;people.index&quot;</code></li>
<li><strong><code>model</code></strong> <em>...Object|Array|Number|String</em>: Optionally pass an arbitrary amount of models or identifiers for each dynamic segment to be use for generation.</li>
</ul>
<p><em>Named Params</em></p>
<ul>
<li><strong><code>models</code></strong> <em>Object|Array|Number|String</em>: Same as the positional parameter. It is a compiler error if the positional params and the named param is used.</li>
<li><strong><code>queryParms</code></strong> <em>Object</em>: Optionally pass key value pairs that will be serialized</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><em>String</em>: a root-relative URL as a string (which will include the application's <code>rootUrl</code>)</li>
</ul>
<h3><a class="header" href="#root-url-helper" id="root-url-helper"><code>{{root-url}}</code> Helper</a></h3>
<p><code>{{root-url}}</code> simply returns the value from <code>Application.rootURL</code>. It can be used to prefix any <code>href</code> values you wish to hard code.</p>
<pre><code class="language-hbs">&lt;a href=&quot;{{root-url}}profile&quot;&gt;Profile&lt;/a&gt;
</code></pre>
<p>Will result in the following for the default configuration:</p>
<pre><code class="language-html">&lt;a href=&quot;/profile&quot;&gt;Profile&lt;/a&gt;
</code></pre>
<h4><a class="header" href="#signature-explainer-1" id="signature-explainer-1">Signature Explainer</a></h4>
<p><code>{{root-url}}</code> does not take any parameters.</p>
<h3><a class="header" href="#route-state-helpers" id="route-state-helpers">Route State Helpers</a></h3>
<p>The following helpers are all <em>context dependent</em>, not global. For instance you might have two copies of <code>(is-active &quot;posts&quot;)</code> in your app simultaneously where one is <code>true</code> and one is <code>false</code>, because you're in the middle of an animated transition, or because you're pre-rendering a route that hasn't been entered yet.</p>
<h3><a class="header" href="#is-active-helper" id="is-active-helper"><code>{{is-active}}</code> Helper</a></h3>
<pre><code class="language-hbs">{{is-active 'people.index' model queryParams=(hash a=a)}}
</code></pre>
<p>or</p>
<pre><code class="language-hbs">{{is-active 'people.index' models=model queryParams=(hash a=a)}}
</code></pre>
<p>The arguments to <code>{{is-active}}</code> have the same semantics as <code>{{url-for}}</code>, however the return value is a boolean. This should provide the same logic that determines whether to put an <code>active</code> class on a <code>{{link-to}}</code>.</p>
<h4><a class="header" href="#signature-explainer-2" id="signature-explainer-2">Signature Explainer</a></h4>
<p>Using the example above:</p>
<p><em>Positional Params</em></p>
<ul>
<li><strong><code>routeName</code></strong> <em>String</em>: A fully-qualified name of this route, like <code>&quot;people.index&quot;</code></li>
<li><strong><code>model</code></strong> <em>...Object|Array|Number|String</em>: Optionally pass an arbitrary amount of models to use for generation</li>
</ul>
<p><em>Named Params</em></p>
<ul>
<li><strong><code>models</code></strong> <em>Object|Array|Number|String</em>: Same as the positional parameter. It is a compiler error if the positional params and the named param is used.</li>
<li><strong><code>queryParms</code></strong> <em>Object</em>: Optionally pass key value pairs that will be used to determine if the route is active.</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><em>Boolean</em>: Determines if the route is active or not.</li>
</ul>
<h3><a class="header" href="#is-loading-helper" id="is-loading-helper"><code>{{is-loading}}</code> Helper</a></h3>
<pre><code class="language-hbs">{{is-loading 'people.index' model queryParams=(hash a=a)}}
</code></pre>
<p>Or</p>
<pre><code class="language-hbs">{{is-loading 'people.index' models=model queryParams=(hash a=a)}}
</code></pre>
<p>The arguments to <code>{{is-loading}}</code> have the same semantics as <code>{{url-for}}</code> and <code>{{is-active}}</code>, however if any of the model(s) passed to it are unresolved e.g. evaluate to <code>undefined</code> the helper will return <code>true</code>, otherwise the helper will return <code>false</code>. This should provide the same logic that determines whether to put an <code>loading</code> class on a <code>{{link-to}}</code>.</p>
<h4><a class="header" href="#signature-explainer-3" id="signature-explainer-3">Signature Explainer</a></h4>
<p>Using the example above:</p>
<p><em>Positional Params</em></p>
<ul>
<li><strong><code>routeName</code></strong> <em>String</em>: A fully-qualified name of this route, like <code>&quot;people.index&quot;</code></li>
<li><strong><code>model</code></strong> <em>...Object|Array|Number|String</em>: Optionally pass an arbitrary amount of models to use for generation</li>
</ul>
<p><em>Named Params</em></p>
<ul>
<li><strong><code>models</code></strong> <em>Object|Array|Number|String</em>: Same as the positional parameter. It is a compiler error if the positional params and the named param is used.</li>
<li><strong><code>queryParms</code></strong> <em>Object</em>: Optionally pass key value pairs that will be used to determine if the route is loading.</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><em>Boolean</em>: Determines if the route is loading or not.</li>
</ul>
<h3><a class="header" href="#is-transitioning-in-helper" id="is-transitioning-in-helper"><code>{{is-transitioning-in}}</code> Helper</a></h3>
<pre><code class="language-hbs">{{is-transitioning-in 'people.index' model queryParams=(hash a=a)}}
</code></pre>
<p>Or</p>
<pre><code class="language-hbs">{{is-transitioning-in 'people.index' models=model queryParams=(hash a=a)}}
</code></pre>
<p>The arguments to <code>{{is-transitioning-in}}</code> have the same semantics as all the other route state helpers, however <code>{{is-transitioning-in}}</code> only returns <code>true</code> when the route is going from an non-active to an active state. This should provide the same logic that determines whether to put an <code>ember-transition-in</code> class on a <code>{{link-to}}</code>.</p>
<h4><a class="header" href="#signature-explainer-4" id="signature-explainer-4">Signature Explainer</a></h4>
<p>Using the example above:</p>
<p><em>Positional Params</em></p>
<ul>
<li><strong><code>routeName</code></strong> <em>String</em>: A fully-qualified name of this route, like <code>&quot;people.index&quot;</code></li>
<li><strong><code>model</code></strong> <em>...Object|Array|Number|String</em>: Optionally pass an arbitrary amount of models to use for generation</li>
</ul>
<p><em>Named Params</em></p>
<ul>
<li><strong><code>models</code></strong> <em>Object|Array|Number|String</em>: Same as the positional parameter. It is a compiler error if the positional params and the named param is used.</li>
<li><strong><code>queryParms</code></strong> <em>Object</em>:  Optionally pass key value pairs that will be used to determine if the route is transitioning in.</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><em>Boolean</em>: Determines if the route is transitioning in.</li>
</ul>
<h3><a class="header" href="#is-transitioning-out-helper" id="is-transitioning-out-helper"><code>{{is-transitioning-out}}</code> Helper</a></h3>
<pre><code class="language-hbs">{{is-transitioning-out 'people.index' model queryParams=(hash a=a)}}
</code></pre>
<p>Or</p>
<pre><code class="language-hbs">{{is-transitioning-out 'people.index' models=model queryParams=(hash a=a)}}
</code></pre>
<p><code>{{is-transitioning-out}}</code> is just the inverse of <code>{{is-transitioning-in}}</code>.</p>
<h4><a class="header" href="#signature-explainer-5" id="signature-explainer-5">Signature Explainer</a></h4>
<p>Using the example above:</p>
<p><em>Positional Params</em></p>
<ul>
<li><strong><code>routeName</code></strong> <em>String</em>: A fully-qualified name of this route, like <code>&quot;people.index&quot;</code></li>
<li><strong><code>model</code></strong> <em>...Object|Array|Number|String</em>: Optionally pass an arbitrary amount of models to use for generation</li>
</ul>
<p><em>Named Params</em></p>
<ul>
<li><strong><code>models</code></strong> <em>Object|Array|Number|String</em>: Same as the positional parameter. It is a compiler error if the positional params and the named param is used.</li>
<li><strong><code>queryParms</code></strong> <em>Object</em>:  Optionally pass key value pairs that will be used to determine if the route is transitioning out.</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><em>Boolean</em>: Determines if the route is transitioning out.</li>
</ul>
<h3><a class="header" href="#event-dispatcher" id="event-dispatcher">Event Dispatcher</a></h3>
<p>In the past, only <code>HTMLAnchorElement</code>s that were produced by <code>{{link-to}}</code>s would produce a transition when a user clicked on them. This RFC changes to the global <code>EventDispatcher</code> to allow for any <code>HTMLAnchorElement</code> with a valid root relative <code>href</code> to cause a transition. This will allow for us to not only allows us to support use cases like the ones described in the <a href="#anchor-tags">motivation</a>, it makes teaching easier since people who know HTML don't need know an Ember specific API to participate in routing transitions.</p>
<h4><a class="header" href="#route-globs-and-route-blacklisting" id="route-globs-and-route-blacklisting">Route Globs And Route Blacklisting</a></h4>
<p>While the vast majority of the time developers want root relative URLs to cause a transition there are cases where you want root relative urls to cause a normal HTTP navigation. In the router map you can define <a href="https://guides.emberjs.com/release/routing/defining-your-routes/#toc_wildcard--globbing-routes">wildcard / globbing</a> that makes this problematic as any root relative url can be catched by a wildcard route. To solve this issue this RFC proposes expanding the route options to allow for a black list of urls that are allowed to cause a normal HTTP navigation.</p>
<pre><code class="language-js">Router.map(function() {
  this.route('not-found', { path: '/*path', blacklist: ['/contact-us', '/order/:order_id'] });
});
</code></pre>
<p>When an event comes into the <code>EventDispatcher</code> we will cross check the blacklist to see if the event should be let through to the browser or if it should be handled internally.</p>
<h3><a class="header" href="#transition-attribution" id="transition-attribution">Transition Attribution</a></h3>
<p>This RFC introduces the notion of an <code>attribution</code> to the <code>Transition</code>. The <code>TransitionAttribution</code> is a read-only object that has 2 fields <code>event</code> and <code>source</code>.</p>
<pre><code class="language-ts">interface TransitionAttribution {
  readonly event: Maybe&lt;Event&gt;;
  readonly source: unknown
}

interface Transition {
  readonly attribution: TransitionAttribution;
}
</code></pre>
<p>On initial render <code>event</code> and <code>source</code> will be <code>null</code>. On subsequent transitions, the <code>event</code> will be the DOM event that caused the transition and <code>element</code> will be populated with <code>HTMLElement</code> that the user interacted with to cause the transition. See <a href="#appendix-a">Appendix A</a> for example usage. In the event that the transition occurs programmatically through an API like <code>replaceWith</code> or <code>transitionTo</code> the <code>event</code> will be <code>null</code> but can be <a href="#programatic-attribution">populated by the caller</a>.</p>
<h4><a class="header" href="#programatic-attribution" id="programatic-attribution">Programatic Attribution</a></h4>
<p>In cases where you need to programatically transition with <code>transitionTo</code> or <code>replaceWith</code> we will allow for you to pass your own <code>TransitionAttribution</code>. See Appendix B for an example.</p>
<pre><code class="language-ts">interface Options {
  queryParams?: Dict&lt;string|number&gt;,
  attribution?: TransitionAttribution;
}

interface Router /* Route, RouterService */ {
  //...
  transitionTo(routeName: string, models?: string|number|object, options?: Options): Transition;
  replaceWith(routeName: string, models?: string|number|object, options?: Options): Transition;
}
</code></pre>
<h4><a class="header" href="#transitionattribution-integrity" id="transitionattribution-integrity"><code>Transition.attribution</code> Integrity</a></h4>
<p>The <code>attribution</code> in a <code>Transition</code> is guaranteed to be carried through the completion of the route transition. This includes <code>abort</code>s, <code>redirect</code>s and <code>retry</code>s of the transition. The <code>attribution</code> field is readonlu and the <code>TransitionAttribution</code> is readonly and frozen.</p>
<h2><a class="header" href="#migration-path" id="migration-path">Migration Path</a></h2>
<p>Since this RFC does not deprecate <code>{{link-to}}</code> you can continue to use it. That being said <code>{{link-to}}</code> has static semantics therefore we can write a codemod using <a href="https://github.com/ember-template-lint/ember-template-recast">Ember Template Recast</a> to migrate the code. Below are numerous before and after examples of how the codemod would migrate. It's important to note that the behavior of the application <a href="#url-generation-helpers">will change</a> if you are relying on the passing of the in-memory model. Because of this the codemod would need different levels of conversion.</p>
<h3><a class="header" href="#basic-link-to" id="basic-link-to">Basic <code>{{link-to}}</code></a></h3>
<p><strong>Before:</strong></p>
<pre><code class="language-hbs">{{#link-to 'profile' class=&quot;profile&quot;}}Profile{{/link-to}}
{{link-to 'About' 'about'}}
</code></pre>
<p><strong>After:</strong></p>
<pre><code class="language-hbs">&lt;a href={{url-for 'profile'}} class=&quot;profile&quot;&gt;Profile&lt;/a&gt;
&lt;a href={{url-for 'about'}}&gt;About&lt;/a&gt;
</code></pre>
<h3><a class="header" href="#with-model-link-to" id="with-model-link-to">With Model <code>{{link-to}}</code></a></h3>
<p><strong>Before:</strong></p>
<pre><code class="language-hbs">{{#link-to 'profile' this.profile class=&quot;profile&quot;}}Profile{{/link-to}}
{{link-to 'About' 'about' this.contact}}
</code></pre>
<p><strong>After:</strong></p>
<pre><code class="language-hbs">&lt;a class=&quot;profile&quot; href={{url-for 'profile' this.profile}}&gt;Profile&lt;/a&gt;
&lt;a href={{url-for 'about' this.contact}}&gt;About&lt;/a&gt;
</code></pre>
<h3><a class="header" href="#with-query-params-link-to" id="with-query-params-link-to">With Query Params <code>{{link-to}}</code></a></h3>
<p><strong>Before:</strong></p>
<pre><code class="language-hbs">{{#link-to 'post' this.post (query-params order=&quot;CHRON&quot;)}}{{this.post.name}}{{/link-to}}
</code></pre>
<p><strong>After:</strong></p>
<pre><code class="language-hbs">&lt;a href={{url-for 'post' this.post queryParms=(hash order=&quot;CHRON&quot;)}}&gt;{{this.post.name}}&lt;/a&gt;
</code></pre>
<p>One of the trickier parts about this migration is knowing how the autogenerated CSS classes are being used. Because of this, adding the route state helpers must explicitly be turned on in the codemod. For instance if you are making heavy use of the <code>.active</code> class, you will be suited best by turning pass the codemod the correct configuration to do a transform like the following:</p>
<p><strong>Before</strong></p>
<pre><code class="language-hbs">{{#link-to 'profile'}}Profile{{/link-to}}
</code></pre>
<p><strong>After</strong></p>
<pre><code class="language-hbs">&lt;a href={{url-for 'profile'}} class={{if (is-active 'profile') 'active'}}&gt;Profile&lt;/a&gt;
</code></pre>
<h4><a class="header" href="#kitchen-sink" id="kitchen-sink">Kitchen Sink</a></h4>
<p>If you were to transform all <code>{{link-to}}</code>s verbatim in terms of functionality this would be the result.</p>
<p><strong>Before</strong></p>
<pre><code class="language-hbs">{{#link-to 'profile' model (query-parmas foo=bar) replace=true}}Profile{{/link-to}}
</code></pre>
<p><strong>After</strong></p>
<pre><code class="language-hbs">&lt;a
  href={{url-for 'profile'
    model
    queryParams=(hash foo=bar)}}
  class=&quot;{{if (is-active 'profile' model queryParams=(hash foo=bar)) 'active'}} {{if (is-loading 'profile' model queryParams=(hash foo=bar)) 'loading'}} {{if (is-transitioning-in 'profile' model queryParams=(hash foo=bar)) 'ember-transitioning-in'}} {{if (is-transitioning-out 'profile' model queryParams=(hash foo=bar)) 'ember-transitioning-out'}}&quot;&gt;Profile&lt;/a&gt;
</code></pre>
<p>As the kitchen sink example shows, <code>{{link-to}}</code> is packed with functionality. While this convienent, it comes with a cost per <code>{{link-to}}</code> and is the reason why addons like <a href="https://github.com/intercom/ember-href-to">Ember-href-to</a> were created. In reality the vast majority of applications only need a subset of this functionality and only in rare cases need things like the transition and loading states.</p>
<h2><a class="header" href="#how-we-teach-this" id="how-we-teach-this">How we teach this</a></h2>
<p>In many ways this vastly simplifies Ember's approach to linking within the app. It removes the requirement for a proprietary API and instead embraces the power of URLs.</p>
<p>In the cases where you do need to do more complicated things like pass in memory models to a route, things should feel very similar to <code>{{link-to}}</code> as they have the exact same signature. In the case of query param serialization, I believe we are actually aligning a mental model as to how URL generation should work.</p>
<h2><a class="header" href="#drawbacks" id="drawbacks">Drawbacks</a></h2>
<p>This RFC expands the surface area of the templating layer by exposing the primitives that make up <code>{{link-to}}</code>. This may cause confusion of choosing between using simple basic anchor tags, <code>{{url-for}}</code> and <code>{{link-to}}</code>, however I believe that each one of the these APIs are solving a real problem that we have in Ember today.</p>
<p>By proxy this may cause people to encapsulate all of these primitives into a single component and thus creating a user-land version of <code>{{link-to}}</code>. This could be seen as a framework misstep if the majority of applications end up depending on the addon.</p>
<h2><a class="header" href="#alternatives" id="alternatives">Alternatives</a></h2>
<p>We could just start deprecating and removing functionality from <code>{{link-to}}</code> itself. That being said, it is hard to understand how much of the community is reliant on certain feature of <code>{{link-to}}</code>. This also doesn't help with usecases like the i18n and markdown use cases.</p>
<h2><a class="header" href="#unresolved-questions" id="unresolved-questions">Unresolved questions</a></h2>
<p>TBD?</p>
<h2><a class="header" href="#appendix-a" id="appendix-a">Appendix A</a></h2>
<pre><code class="language-js">// app/utils/tracking.js
const TRACKING_DATA = new WeakMap();
export default TRACKING_DATA;
</code></pre>
<pre><code class="language-js">// app/components/track-link.js
import Component from '@ember/component';
import TRACKING_DATA from '../utils/tracking';

export default Component.extend({
  tagName: 'a',
  attributeBindings: ['href'],
  didInsertElement() {
    TRACKING_DATA.set(this.element, this.contextName);
  }
})
</code></pre>
<pre><code class="language-js">// app/routes/application.js
import Route from '@ember/routing/route';
import { inject as service } from '@ember/service';
import TRACKING_DATA from '../utils/tracking';

export default Route.extend({
  router: service('router'),
  init() {
    this._super(...arguments);

    this.router.on('routeDidChange', transition =&gt; {
      let { source, event } = trasition.attribution;

      let trackingInfo = {
        cause: event.type,
        contextName: null
      };

      if (TRACKING_DATA.has(trasition.source)) {
        trackingInfo.contextName = TRACKING_DATA.get(source);
      }

      ga.send('pageView', {
        from: transition.from ? transition.from.name : 'initial',
        to: transition.to.name,
        attribution: trackingInfo
      });
    });
  }
})
</code></pre>
<pre><code class="language-hbs">&lt;h1&gt;Hello {{@name}}!&lt;/h1&gt;
&lt;TrackLink href=&quot;/profile&quot; @contextName=&quot;profile.link&quot;&gt;Profile&lt;/TrackLink&gt;
&lt;TrackLink href=&quot;/about&quot; @contextName=&quot;about.link&quot;&gt;About&lt;/TrackLink&gt;
&lt;TrackLink href=&quot;/contact&quot; @contextName=&quot;contact.link&quot;&gt;Contact&lt;/TrackLink&gt;
</code></pre>
<h2><a class="header" href="#appendix-b" id="appendix-b">Appendix B</a></h2>
<pre><code class="language-js">// app/utils/tracking.js
const TRACKING_DATA = new WeakMap();
export default TRACKING_DATA;
</code></pre>
<pre><code class="language-js">// app/routes/profile.js
import Route from '@ember/routing/route';
import { inject as service } from '@ember/service';
import TRACKING_DATA from '../utils/tracking';

export default Route.extend({
  store: service('store'),
  actions: {
    changeName(name) {
      this.model.set('name', name);
    },

    changeAge(age) {
      this.model.set('age', age);
    },

    submit(e) {
      if (isValid(this.model)) {
        let attribution = {
          event: e,
          source: e.target,
        };

        TRACKING_DATA.set(e.target, 'profile.submit');

        this.model.save().then(() =&gt; {
          this.transitionTo('profile.success', { attribution });
        }, () =&gt; {
          alert('Issue saving... please try again.');
        });
      } else {
        alert('Data is not valid!');
      }
    }
  }
})
</code></pre>
<pre><code class="language-hbs">&lt;input onchange={{action 'changeName' value=&quot;target.value&quot;}} /&gt;
&lt;input onchange={{action 'changeAge' value=&quot;target.value&quot;}} /&gt;
&lt;button onclick={{action 'submit' this.model}}&gt;Submit&lt;/button&gt;
</code></pre>
<pre><code class="language-js">// app/routes/application.js
import Route from '@ember/routing/route';
import { inject as service } from '@ember/service';
import TRACKING_DATA from '../utils/tracking';

export default Route.extend({
  router: service('router'),
  init() {
    this._super(...arguments);

    this.router.on('routeDidChange', transition =&gt; {
      let { source, event } = trasition.attribution;

      let trackingInfo = {
        cause: event.type,
        contextName: null
      };

      if (TRACKING_DATA.has(trasition.source)) {
        trackingInfo.contextName = TRACKING_DATA.get(source);
      }

      ga.send('pageView', {
        from: transition.from ? transition.from.name : 'initial',
        to: transition.to.name,
        attribution: trackingInfo
      });
    });
  }
})
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="0389-dynamic-tag-names.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="0392-deprecate-component-manager-string-lookup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="0389-dynamic-tag-names.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="0392-deprecate-component-manager-string-lookup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
